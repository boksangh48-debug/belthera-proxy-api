<!doctype html>
<html lang="ko">
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>보안 브라우저로 열기</title>
<style>
  body{font-family:system-ui,Apple SD Gothic Neo,Segoe UI,Roboto,Arial;
       margin:0;padding:24px;line-height:1.5;background:#fafafa}
  .card{max-width:560px;margin:0 auto;padding:20px;border:1px solid #e5e7eb;border-radius:16px;background:#fff}
  h1{margin:0 0 8px} p{margin:8px 0}
  .btn{display:inline-block;margin-top:14px;padding:12px 16px;border-radius:12px;
       border:0;background:#111;color:#fff;font-weight:700;text-decoration:none}
  .hint{font-size:13px;color:#6b7280}
</style>
<body>
  <div class="card">
    <h1>보안 브라우저로 열어드릴게요</h1>
    <p>현재 창(인앱 브라우저)에선 Google 로그인이 차단됩니다.<br>안전한 브라우저로 이동 중…</p>
    <a id="openExternal" class="btn" target="_blank" rel="noopener">외부 브라우저로 열기</a>
    <p class="hint">안되면 오른쪽 위 메뉴(⋯) → “기타 브라우저로 열기”를 선택해주세요.</p>
  </div>

<script>
(function(){
  const qs = new URLSearchParams(location.search);
  // 이동할 실제 목적지 (파라미터로 받음)
  const target = qs.get('to') || 'https://belthera-proxy-api.vercel.app/';

  const ua = navigator.userAgent.toLowerCase();
  const isAndroid = /android/.test(ua);
  const isIOS = /iphone|ipad|ipod/.test(ua);
  const isInApp =
    /(kakao|line|fbav|instagram|naver|daum|wv)/.test(ua) ||
    (window.navigator.standalone === false);

  // 버튼 기본 세팅
  const btn = document.getElementById('openExternal');
  btn.href = target;

  if (!isInApp) {
    // 인앱이 아니면 그냥 이동
    location.replace(target);
    return;
  }

  if (isAndroid) {
    // ANDROID: 크롬 인텐트로 강제 오픈
    const noScheme = target.replace(/^https?:\/\//, '');
    const intent =
      `intent://${noScheme}#Intent;scheme=https;package=com.android.chrome;` +
      `S.browser_fallback_url=${encodeURIComponent(target)};end`;
    location.href = intent;
    setTimeout(()=>{ btn.style.display='inline-block'; }, 800);
  } else if (isIOS) {
    // iOS: 팝업 시도 + 버튼 노출
    const w = window.open(target, '_blank', 'noopener');
    if (!w) {
      btn.style.display='inline-block';
    }
  } else {
    location.href = target;
  }
})();
</script>
</body>
</html>

