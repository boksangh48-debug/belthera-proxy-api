<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Belthera 감정리딩 타로</title>

<!-- Open Graph / SNS 미리보기 (썸네일: 업로드한 사진) -->
<meta property="og:url" content="https://belthera-proxy-api.vercel.app/external-gate.html">
<meta property="og:type" content="website">
<meta property="og:title" content="Belthera 감정리딩 타로">
<meta property="og:description" content="하루 3분, 마음의 리듬을 읽어드립니다. 인앱에서도 안전 브라우저로 전환!">
<meta property="og:image" content="https://belthera-proxy-api.vercel.app/KakaoTalk_20250807_083829974.jpg">
<meta property="og:image:width" content="800">
<meta property="og:image:height" content="800">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="Belthera 감정리딩 타로">
<meta name="twitter:description" content="하루 3분, 마음의 리듬을 읽어드립니다.">
<meta name="twitter:image" content="https://belthera-proxy-api.vercel.app/KakaoTalk_20250807_083829974.jpg">
<link rel="canonical" href="https://belthera-proxy-api.vercel.app/external-gate.html" />

<style>
  :root{--bg:#0b0b0c;--fg:#fff;--muted:#9ca3af;--accent:#10b981;--line:#1f2937}
  *{box-sizing:border-box}
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Apple SD Gothic Neo,Arial;margin:0;background:var(--bg);color:var(--fg)}
  .wrap{max-width:720px;margin:0 auto;padding:24px}
  .card{padding:22px;border:1px solid var(--line);border-radius:18px;background:#111;box-shadow:0 10px 20px rgba(0,0,0,.25)}
  h1{margin:0 0 10px;font-size:22px}
  p{margin:8px 0;color:var(--muted)}
  .btn{display:block;width:100%;text-align:center;margin-top:14px;padding:16px;border-radius:14px;border:0;
       background:var(--accent);color:#001410;font-weight:800;text-decoration:none;font-size:17px}
  .row{display:flex;gap:10px;margin-top:14px;flex-wrap:wrap}
  .btn2{flex:1;display:inline-block;text-align:center;padding:12px;border-radius:12px;border:1px solid #374151;
        color:#e5e7eb;text-decoration:none;background:#0f172a}
  .hint{font-size:13px;color:#9ca3af;margin-top:8px}
  hr{border:none;border-top:1px solid var(--line);margin:18px 0}

  /* iOS 가이드 오버레이 */
  .overlay{position:fixed;inset:0;background:rgba(0,0,0,.7);display:none;align-items:center;justify-content:center;z-index:9999}
  .sheet{background:#111;border:1px solid var(--line);border-radius:18px;max-width:560px;margin:16px;padding:18px}
  .sheet h2{margin:0 0 8px;font-size:18px}
  .steps{font-size:14px;color:#cbd5e1;line-height:1.6}
  .close{margin-top:12px;display:block;text-align:center;padding:10px;border-radius:10px;background:#334155;color:#fff;text-decoration:none}
</style>
</head>
<body>
<div class="wrap">
  <div class="card">
    <h1>보안 브라우저로 열어드릴게요</h1>
    <p>현재 창(인앱 브라우저)에선 로그인/결제가 제한될 수 있어요.<br>안전한 브라우저(사파리/크롬)로 열어주세요.</p>

    <!-- 메인 CTA -->
    <a id="openExternal" class="btn" target="_blank" rel="noopener">사파리/크롬으로 열기</a>

    <!-- 보조 액션 -->
    <div class="row">
      <a id="copyLink" class="btn2" href="#">링크 복사</a>
      <a id="openNew" class="btn2" target="_blank" rel="noopener">새 탭으로 열기</a>
      <a id="showGuide" class="btn2" href="#">iOS 사용법</a>
    </div>

    <hr />
    <p>더 깊이 있는 1:1 상담이 필요하신가요?</p>
    <div class="row">
      <a class="btn2" href="https://kmong.com/gig/646792" target="_blank" rel="noopener">🔮 크몽 상담 바로가기</a>
      <a class="btn2" href="https://m.expert.naver.com/expert/profile/home?storeId=100055123" target="_blank" rel="noopener">🌟 네이버 엑스퍼트 상담</a>
    </div>

    <p class="hint">안되면 오른쪽 위 메뉴(⋯) → “기타 브라우저로 열기”, 또는 공유하기 → “사파리로 열기”.</p>
  </div>
</div>

<!-- iOS 오버레이 -->
<div id="iosOverlay" class="overlay" role="dialog" aria-modal="true">
  <div class="sheet">
    <h2>아이폰에서 열기</h2>
    <div class="steps">
      1) 화면 아래 <b>공유</b> 버튼(⬆️) 탭<br>
      2) 아래로 스크롤 → <b>사파리로 열기</b> 선택<br>
      3) 또는 위의 <b>사파리/크롬으로 열기</b> 버튼을 한 번 더 탭
    </div>
    <a id="closeOverlay" class="close" href="#">확인</a>
  </div>
</div>

<script>
(function(){
  const qs = new URLSearchParams(location.search);
  const target = qs.get('to') || 'https://belthera-proxy-api.vercel.app/';
  const openBtn = document.getElementById('openExternal');
  const openNew = document.getElementById('openNew');
  const copyBtn = document.getElementById('copyLink');
  const showGuide = document.getElementById('showGuide');
  const overlay = document.getElementById('iosOverlay');
  const closeOverlay = document.getElementById('closeOverlay');

  openBtn.href = target;
  openNew.href = target;

  const ua = navigator.userAgent.toLowerCase();
  const isAndroid = /android/.test(ua);
  const isIOS = /iphone|ipad|ipod/.test(ua);
  const isInApp = /(kakao|line|fbav|instagram|naver|daum|wv)/.test(ua) || (window.navigator.standalone === false);

  // 첫 터치 시 iOS에서 새 탭 오픈 시도 (사용자 제스처로 인정)
  if (isIOS && isInApp) {
    const tryOpenOnce = () => {
      window.open(target, '_blank', 'noopener');
      document.removeEventListener('touchstart', tryOpenOnce);
      document.removeEventListener('click', tryOpenOnce);
    };
    document.addEventListener('touchstart', tryOpenOnce, {once:true});
    document.addEventListener('click', tryOpenOnce, {once:true});
  }

  // 안드로이드는 인텐트로 외부 크롬 시도 (버튼 눌렀을 때)
  openBtn.addEventListener('click', (e)=>{
    if (isAndroid && isInApp) {
      e.preventDefault();
      const noScheme = target.replace(/^https?:\/\//,'');
      const intent = `intent://${noScheme}#Intent;scheme=https;package=com.android.chrome;S.browser_fallback_url=${encodeURIComponent(target)};end`;
      location.href = intent;
    } else if (isIOS && isInApp) {
      // iOS 인앱: 버튼 누르면 오버레이로 안내 + 새 탭 시도
      overlay.style.display = 'flex';
      // 보조로 한 번 더 오픈 시도
      setTimeout(()=>window.open(target, '_blank', 'noopener'), 0);
      // 기본 동작은 유지(새 탭 target)
    }
    // 일반 브라우저에서는 a[target=_blank] 기본 동작
  });

  // iOS 가이드 수동 표시
  showGuide.addEventListener('click', (e)=>{ e.preventDefault(); overlay.style.display='flex'; });
  closeOverlay.addEventListener('click', (e)=>{ e.preventDefault(); overlay.style.display='none'; });

  // 링크 복사
  copyBtn.addEventListener('click', async (e)=>{
    e.preventDefault();
    try {
      await navigator.clipboard.writeText(location.href);
      copyBtn.textContent = '복사됨 ✅';
      setTimeout(()=>copyBtn.textContent='링크 복사', 1500);
    } catch(e) {
      alert('복사에 실패했어요. 길게 눌러 복사해 주세요.');
    }
  });
})();
</script>
</body>
</html>
